<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeLink - Secure URL Shortener</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .professional-bg {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
        }
        .security-badge {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .popup-overlay {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }
        .popup-slide-in {
            animation: slideInUp 0.5s ease-out;
        }
        @keyframes slideInUp {
            from { 
                opacity: 0; 
                transform: translateY(100px) scale(0.9); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        .spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="professional-bg min-h-screen">
    <!-- Professional Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center mr-3">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <h1 class="text-xl font-bold text-gray-900">SafeLink</h1>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="security-badge text-white text-xs font-medium px-3 py-1 rounded-full">
                        ðŸ”’ Secure
                    </span>
                </div>
            </div>
        </div>
    </header>

    <!-- Page 1: Initial Loading -->
    <div id="page1" class="pt-16 min-h-screen flex items-center justify-center fade-in">
        <!-- Banner Ad Container -->
        <div class="fixed top-20 right-4 z-40 hidden lg:block">
            <div id="bannerAd1" class="bg-white rounded-lg shadow-lg p-2 min-h-[300px] w-[160px] border border-gray-200">
                <div class="text-xs text-gray-500 text-center mb-2">Advertisement</div>
                <div id="bannerContent1" class="w-full h-full flex items-center justify-center text-gray-400 text-xs">Loading ad...</div>
            </div>
        </div>
        
        <div class="max-w-lg mx-auto bg-white rounded-xl card-shadow p-8 text-center">
            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <svg class="w-8 h-8 text-blue-600 spinner" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 mb-2">Preparing Your Link</h2>
            <p class="text-gray-600 mb-8">We're setting up a secure connection to ensure your safety</p>
            
            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
                    <span>Progress</span>
                    <span><span id="timer1">10</span>s</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progress1" class="progress-bar h-2 rounded-full transition-all duration-[10000ms] ease-linear" style="width: 0%"></div>
                </div>
            </div>

            <div class="flex items-center justify-center space-x-2 text-sm text-gray-500 mb-6">
                <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                <span>Step 1 of 4</span>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
            </div>

            <button id="continueBtn1" onclick="skipToNext()" class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium hidden">
                Continue to Next Step
            </button>
        </div>
    </div>

    <!-- Page 2: Security Check -->
    <div id="page2" class="pt-16 min-h-screen flex items-center justify-center hidden">
        <!-- Banner Ad Container -->
        <div class="fixed top-20 right-4 z-40 hidden lg:block">
            <div id="bannerAd2" class="bg-white rounded-lg shadow-lg p-2 min-h-[300px] w-[160px] border border-gray-200">
                <div class="text-xs text-gray-500 text-center mb-2">Advertisement</div>
                <div id="bannerContent2" class="w-full h-full flex items-center justify-center text-gray-400 text-xs">Loading ad...</div>
            </div>
        </div>
        
        <div class="max-w-lg mx-auto bg-white rounded-xl card-shadow p-8 text-center fade-in">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <svg class="w-8 h-8 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 mb-2">Security Verification</h2>
            <p class="text-gray-600 mb-8">Running comprehensive security checks on your destination</p>
            
            <div class="space-y-3 mb-8">
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center">
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                        <span class="text-sm font-medium text-gray-700">SSL Certificate</span>
                    </div>
                    <span class="text-sm text-green-600 font-medium">âœ“ Verified</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center">
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                        <span class="text-sm font-medium text-gray-700">Malware Scan</span>
                    </div>
                    <span class="text-sm text-green-600 font-medium">âœ“ Clean</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center">
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                        <span class="text-sm font-medium text-gray-700">Phishing Protection</span>
                    </div>
                    <span class="text-sm text-green-600 font-medium">âœ“ Safe</span>
                </div>
            </div>

            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
                    <span>Security Check</span>
                    <span><span id="timer2">10</span>s</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progress2" class="progress-bar h-2 rounded-full transition-all duration-[10000ms] ease-linear" style="width: 0%"></div>
                </div>
            </div>

            <div class="flex items-center justify-center space-x-2 text-sm text-gray-500 mb-6">
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                <span>Step 2 of 4</span>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
            </div>

            <button id="continueBtn2" onclick="skipToNext()" class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium hidden">
                Continue to Next Step
            </button>
        </div>
    </div>

    <!-- Page 3: Preparing Redirect -->
    <div id="page3" class="pt-16 min-h-screen flex items-center justify-center hidden">
        <!-- Banner Ad Container -->
        <div class="fixed top-20 right-4 z-40 hidden lg:block">
            <div id="bannerAd3" class="bg-white rounded-lg shadow-lg p-2 min-h-[300px] w-[160px] border border-gray-200">
                <div class="text-xs text-gray-500 text-center mb-2">Advertisement</div>
                <div id="bannerContent3" class="w-full h-full flex items-center justify-center text-gray-400 text-xs">Loading ad...</div>
            </div>
        </div>
        
        <div class="max-w-lg mx-auto bg-white rounded-xl card-shadow p-8 text-center fade-in">
            <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <svg class="w-8 h-8 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                </svg>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 mb-2">Preparing Redirect</h2>
            <p class="text-gray-600 mb-8">Optimizing connection and preparing your destination</p>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8">
                <div class="flex items-start">
                    <div class="flex-shrink-0">
                        <svg class="w-5 h-5 text-blue-600 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="ml-3 text-left">
                        <h3 class="text-sm font-medium text-blue-800">Connection Status</h3>
                        <div class="mt-2 text-sm text-blue-700">
                            <p class="text-xs">Establishing secure connection to destination server...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
                    <span>Preparing Connection</span>
                    <span><span id="timer3">10</span>s</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progress3" class="progress-bar h-2 rounded-full transition-all duration-[10000ms] ease-linear" style="width: 0%"></div>
                </div>
            </div>

            <div class="flex items-center justify-center space-x-2 text-sm text-gray-500 mb-6">
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                <span>Step 3 of 4</span>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
            </div>

            <button id="continueBtn3" onclick="skipToNext()" class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium hidden">
                Continue to Next Step
            </button>
        </div>
    </div>

    <!-- Page 4: Final Redirect -->
    <div id="page4" class="pt-16 min-h-screen flex items-center justify-center hidden">
        <!-- Banner Ad Container -->
        <div class="fixed top-20 right-4 z-40 hidden lg:block">
            <div id="bannerAd4" class="bg-white rounded-lg shadow-lg p-2 min-h-[300px] w-[160px] border border-gray-200">
                <div class="text-xs text-gray-500 text-center mb-2">Advertisement</div>
                <div id="bannerContent4" class="w-full h-full flex items-center justify-center text-gray-400 text-xs">Loading ad...</div>
            </div>
        </div>
        
        <div class="max-w-lg mx-auto bg-white rounded-xl card-shadow p-8 text-center fade-in">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <svg class="w-8 h-8 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 mb-2">Ready to Redirect</h2>
            <p class="text-gray-600 mb-8">All security checks passed. You're ready to proceed safely.</p>
            
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-8">
                <div class="flex items-start">
                    <div class="flex-shrink-0">
                        <svg class="w-5 h-5 text-green-600 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="ml-3 text-left">
                        <h3 class="text-sm font-medium text-green-800">Security Verification Complete</h3>
                        <div class="mt-2 text-sm text-green-700">
                            <p class="text-xs">All security checks passed. Connection is safe and verified.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
                    <span>Final Redirect</span>
                    <span><span id="timer4">10</span>s</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progress4" class="progress-bar h-2 rounded-full transition-all duration-[10000ms] ease-linear" style="width: 0%"></div>
                </div>
            </div>

            <div class="flex items-center justify-center space-x-2 text-sm text-gray-500 mb-6">
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                <span>Step 4 of 4</span>
            </div>

            <button id="continueBtn4" onclick="redirectNow()" class="w-full px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium hidden">
                Proceed to Destination
            </button>
        </div>
    </div>

    <!-- Telegram Popup Ad -->
    <div id="telegramPopup" class="fixed inset-0 popup-overlay flex items-center justify-center z-50 hidden">
        <div class="max-w-sm mx-4 bg-white rounded-xl card-shadow p-6 text-center popup-slide-in">
            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 0C5.374 0 0 5.373 0 12s5.374 12 12 12 12-5.373 12-12S18.626 0 12 0zm5.568 8.16c-.169 1.858-.896 6.728-.896 6.728-.377 2.617-1.407 3.08-2.896 1.596l-2.123-1.596-1.018.96c-.112.112-.208.208-.427.208-.281 0-.233-.106-.328-.374L9.292 13.2l-3.457-1.084c-.75-.234-.763-.75.165-1.117L16.974 6.24c.612-.234 1.139.15.594 1.92z"/>
                </svg>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2">ðŸŽ¬ Join BILLA TV</h3>
            <p class="text-gray-600 text-sm mb-6">Get exclusive content, movies, and updates on our Telegram channel while you wait!</p>
            <div class="space-y-3">
                <a href="https://t.me/BILLA_TV" target="_blank" class="block w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                    ðŸ“± Join Channel
                </a>
                <button onclick="closePopup()" class="w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors text-sm">
                    Continue Without Joining
                </button>
            </div>
        </div>
    </div>

    <script>
        // Get the URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const targetUrl = urlParams.get('url');
        
        let currentPage = 1;
        let timers = {};

        // Load ad script function with debugging
        function loadAdScript() {
            console.log('Loading popup ad script...');
            
            // Create popup ad script element
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = '//pl26491935.profitableratecpm.com/ee/8a/ec/ee8aec47e3b12dff83910a96932dc116.js';
            script.async = true;
            
            // Add load and error handlers
            script.onload = function() {
                console.log('Popup ad script loaded successfully');
            };
            
            script.onerror = function() {
                console.log('Popup ad script failed to load');
            };
            
            // Append to head
            document.head.appendChild(script);
        }

        // Load banner ad function with multiple fallbacks
        function loadBannerAd(pageNum) {
            console.log('Loading banner ad for page:', pageNum);
            
            const bannerContainer = document.getElementById(`bannerContent${pageNum}`);
            if (!bannerContainer) {
                console.log('Banner container not found for page:', pageNum);
                return;
            }
            
            // Show immediate placeholder
            bannerContainer.innerHTML = `
                <div class="w-full h-full bg-gradient-to-br from-blue-50 to-purple-50 border-2 border-dashed border-blue-200 rounded-lg flex flex-col items-center justify-center text-center p-4">
                    <div class="animate-pulse">
                        <div class="w-8 h-8 bg-blue-400 rounded-full mb-2 mx-auto"></div>
                        <div class="text-xs text-blue-600 font-medium">Loading Ad...</div>
                        <div class="text-xs text-gray-500 mt-1">160x300</div>
                    </div>
                </div>
            `;
            
            // Try multiple ad networks
            setTimeout(() => {
                // Method 1: Try original ad network
                tryLoadAd1(bannerContainer, pageNum);
            }, 500);
            
            setTimeout(() => {
                // Method 2: Try alternative approach
                tryLoadAd2(bannerContainer, pageNum);
            }, 2000);
            
            setTimeout(() => {
                // Method 3: Show demo ad if nothing loaded
                showDemoAd(bannerContainer, pageNum);
            }, 5000);
        }
        
        function tryLoadAd1(container, pageNum) {
            console.log('Trying ad method 1 for page:', pageNum);
            
            // Set global ad options
            window.atOptions = {
                'key': 'e54adc0da5267997f7c3888e3db3ef97',
                'format': 'iframe',
                'height': 300,
                'width': 160,
                'params': {}
            };
            
            // Create script element for ad
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = '//www.highperformanceformat.com/e54adc0da5267997f7c3888e3db3ef97/invoke.js';
            script.async = true;
            
            script.onload = function() {
                console.log('Ad script loaded for page:', pageNum);
            };
            
            script.onerror = function() {
                console.log('Ad script failed for page:', pageNum);
                tryLoadAd2(container, pageNum);
            };
            
            document.head.appendChild(script);
        }
        
        function tryLoadAd2(container, pageNum) {
            console.log('Trying ad method 2 for page:', pageNum);
            
            // Create a simple iframe ad placeholder
            const iframe = document.createElement('iframe');
            iframe.width = '160';
            iframe.height = '300';
            iframe.style.border = 'none';
            iframe.style.background = '#f8f9fa';
            iframe.src = 'data:text/html,<html><body style="margin:0;padding:20px;font-family:Arial;text-align:center;background:linear-gradient(45deg,#e3f2fd,#f3e5f5);"><div style="margin-top:100px;"><h3 style="color:#666;">Advertisement</h3><p style="color:#999;font-size:12px;">160x300 Banner</p></div></body></html>';
            
            // Clear container and add iframe
            container.innerHTML = '';
            container.appendChild(iframe);
        }
        
        function showDemoAd(container, pageNum) {
            console.log('Showing demo ad for page:', pageNum);
            
            // Show attractive demo ad if real ads don't load
            container.innerHTML = `
                <div class="w-full h-full bg-gradient-to-br from-green-400 via-blue-500 to-purple-600 rounded-lg flex flex-col items-center justify-center text-white text-center p-3 shadow-lg">
                    <div class="text-lg font-bold mb-2">ðŸŽ¯</div>
                    <div class="text-xs font-semibold mb-1">Your Ad Here</div>
                    <div class="text-xs opacity-90 mb-2">Premium Placement</div>
                    <div class="text-xs bg-white bg-opacity-20 px-2 py-1 rounded">160x300</div>
                    <div class="text-xs mt-2 opacity-75">Demo Advertisement</div>
                </div>
            `;
        }

        // Trigger ads on each page
        function triggerAds() {
            console.log('Triggering ads for page:', currentPage);
            
            // Try to trigger ads if the script has loaded
            setTimeout(() => {
                // Some ad networks need a delay to initialize
                if (typeof window.adsbygoogle !== 'undefined') {
                    console.log('AdSense detected, pushing ads');
                    (window.adsbygoogle = window.adsbygoogle || []).push({});
                }
                
                // Try to call any global ad functions that might exist
                if (typeof window.showAd === 'function') {
                    window.showAd();
                }
                
                // Re-load the script to trigger new ads
                loadAdScript();
            }, 1000);
        }

        function startTimer(pageNum) {
            let timeLeft = 10; // Always 10 seconds per page
            const timerElement = document.getElementById(`timer${pageNum}`);
            const progressElement = document.getElementById(`progress${pageNum}`);
            const continueBtn = document.getElementById(`continueBtn${pageNum}`);
            
            // Trigger ads when page starts
            triggerAds();
            
            // Load banner ad for current page
            loadBannerAd(pageNum);
            
            // Start progress bar animation (10 seconds)
            setTimeout(() => {
                progressElement.style.width = '100%';
            }, 100);
            
            // Update countdown every second
            timers[pageNum] = setInterval(() => {
                timeLeft--;
                if (timerElement) {
                    timerElement.textContent = timeLeft;
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timers[pageNum]);
                    // Show continue button when timer completes
                    if (continueBtn) {
                        continueBtn.classList.remove('hidden');
                        continueBtn.classList.add('fade-in');
                    }
                    // Don't auto-advance anymore, wait for user click
                }
            }, 1000);
        }

        function showNextPage() {
            // Hide current page
            document.getElementById(`page${currentPage}`).classList.add('hidden');
            
            // Show next page
            currentPage++;
            const nextPage = document.getElementById(`page${currentPage}`);
            nextPage.classList.remove('hidden');
            nextPage.classList.add('fade-in');
            
            // Show popup only on page 3
            if (currentPage === 3) {
                schedulePopup();
            }
            
            // Start timer for new page
            startTimer(currentPage);
        }

        function skipToNext() {
            // Clear current timer
            if (timers[currentPage]) {
                clearInterval(timers[currentPage]);
            }
            
            // Go to next page or redirect if on last page
            if (currentPage < 4) {
                showNextPage();
            } else {
                redirectNow();
            }
        }

        function redirectNow() {
            if (targetUrl) {
                // Clear all timers
                Object.values(timers).forEach(timer => clearInterval(timer));
                
                // Show final message
                document.body.innerHTML = `
                    <div class="professional-bg min-h-screen">
                        <header class="bg-white shadow-sm border-b border-gray-200">
                            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                                <div class="flex justify-between items-center h-16">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 flex items-center">
                                            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center mr-3">
                                                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/>
                                                </svg>
                                            </div>
                                            <h1 class="text-xl font-bold text-gray-900">SafeLink</h1>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <span class="security-badge text-white text-xs font-medium px-3 py-1 rounded-full">
                                            ðŸ”’ Secure
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </header>
                        <div class="pt-16 min-h-screen flex items-center justify-center">
                            <div class="max-w-lg mx-auto bg-white rounded-xl card-shadow p-8 text-center fade-in">
                                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                    <svg class="w-8 h-8 text-blue-600 spinner" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                </div>
                                <h2 class="text-2xl font-bold text-gray-900 mb-2">Redirecting Now</h2>
                                <p class="text-gray-600 mb-6">Taking you to your destination safely...</p>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="progress-bar h-2 rounded-full w-full"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Load ad script one more time on final page
                loadAdScript();
                
                // Redirect after 2 seconds
                setTimeout(() => {
                    window.location.href = targetUrl;
                }, 2000);
            } else {
                alert('No destination URL provided');
            }
        }

        // Popup functions
        function showTelegramPopup() {
            const popup = document.getElementById('telegramPopup');
            popup.classList.remove('hidden');
        }

        function closePopup() {
            const popup = document.getElementById('telegramPopup');
            popup.classList.add('hidden');
        }

        // Show popup on each page after 3 seconds
        function schedulePopup() {
            setTimeout(() => {
                showTelegramPopup();
            }, 3000);
        }

        // Start the first page timer when page loads
        window.addEventListener('load', () => {
            console.log('Page loaded, starting first timer');
            loadAdScript(); // Load popup ad script immediately
            loadBannerAd(1); // Load banner ad for first page
            startTimer(1);
        });

        // Handle browser back button
        window.addEventListener('beforeunload', () => {
            Object.values(timers).forEach(timer => clearInterval(timer));
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'970ab5af77c17a13',t:'MTc1NTQ0OTgzOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
